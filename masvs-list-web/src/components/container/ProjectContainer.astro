---
import useConexion from "@utiles/hooks/Conexion";

const conexion = useConexion();
let projects = [];
let loading = true;

 const fetchProjects =  async () => {
  try {
    const response = await conexion.get(
      `projects/${Astro.cookies.get("user").json().external_id}`
    );
    if (response?.code === 200) {
      projects = response.info;
    }
  } catch (error) {
    console.error("Error al obtener los proyectos:", error);
  }  finally {
  loading = false;
}
};


await fetchProjects();
---

<section class="space-y-8 mt-8" >
    <h2 class="text-2xl font-semibold text-gray-900 dark:text-gray-100">
      Proyectos
    </h2>
    {loading ? (
      <p class="text-gray-500">Cargando proyectos...</p>
    ) : projects.length === 0 ? (
      <p class="text-gray-500">No hay proyectos disponibles.</p>
    ) : (
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {projects.map((project) => (
          <div class="p-4 border rounded-lg shadow-sm bg-white dark:bg-gray-800">
            <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100">
              {project.name}
            </h3>
            <p class="text-gray-700 dark:text-gray-300">
              {project.description}
            </p>
          </div>
        ))}
      </div>
    )}
  </section>
